---
layout: post
title: 图相关算法
subtitle: 常用算法模板系列（七）
date: 2020-09-16
author: John Mactavish
header-img: img/post-bg-dawn-girl-glow.jpg
catalog: true
tags:
  - 算法
---

## 最小生成树(Minimum Spanning Tree)

一个连通的**生成树**是图中的极小连通子图，它包括图中的所有顶点，并且只含尽可能少的边。这意味着对于生成树来说，
若砍去它的一条边，就会使生成树变成非连通图；若给它添加一条边，就会形成图中的一条回路。
对于一个带权连通无向图 `G=(V,E)`，生成树不同，每棵树的权（即树中所有边的权值之和）也可能不同。设 `R` 是 `G` 的所有生成树的集合，
若 `T` 为 `R` 中边的权值之和最小的那棵生成树，则 `T` 称为 `G` 的最小生成树。

最小生成树具有如下性质：

- 最小生成树不是唯一的，即最小生成树的树形不唯一，`R` 中可能有多个最小生成树。
当图中的各边权值互不相等时，G的最小生成树是唯一的。
- 虽然最小生成树不唯一，但其对应的边的权值之和总是唯一的，而且是最小的。
- 最小生成树的边数为顶点数减一。
- 若无向连通图 `G` 的边比顶点数小 1，即 `G` 本身就是一棵树时，`G` 的最小生成树就是它本身。

此外，构造最小生成树的多个算法基本都利用了最小生成树的这个重要性质：

> 假设 `G=（V,E）` 是一个带权连通无向图，`U` 是顶点集 `V` 的一个非空子集。
> 若 `（u，v）` 是满足条件“`u` 含于 `U`，`v` 含于 `V-U`”的边中权值最小的一条，
> 则必**存在**一棵包含边 `（u,v）` 的最小生成树。

基于该性质的两个常用的最小生成树算法是：Prim 算法和 Kruskal 算法，它们都基于贪心算法，
算法正确性的证明参考《算法导论》。

```
void prim(G,T){
	T=空集; //初始化空树
	U={w}; //添加任一顶点w
	while((V-U)!=空集){ //若树中不含全部顶点
		设（u,v）是满足条件“u 含于 U，v 含于 V-U”的边中权值最小的一条；
		T=T并{（u,v）}; //边归入树
		U=U并{v}; //顶点归入树
	}
}

void Kruskal(V,T){
	T=V; //初始化树 T,仅含顶点
	numS=n; //不连通分量数
	while(numS>1){//如果不连通分量树大于 1
		//从 E 中取出权值最小的边（v,u）
		if(v 和 u 分别属于 T 中不同的连通分量){
			T=T并{（v,u）};//将次边加入生成树
			numS--//不连通分量树减1
		}
	}
}
```

Prim 算法的实现的具体步骤一般是:

1. 新建一个 boolean 数组用于标记顶点是否已加入 MST，新建一个用于存储“与 MST 连通子图的边界相邻的顶点”的按连接边权值排序的最小堆
2. 以图中任意点为起点，以它为 MST 起点，把它的所有相邻顶点（同连接边的权值信息一起）加入最小堆
3. 重复下列操作直到最小堆为空：从最小堆中取出边权值最小的顶点，若该点已在 MST 中，进入下一次循环；
否则把这一点加入 MST，把它的所有（不在 MST 内的）相邻点加入最小堆

![prim](https://gonearewe.coding.net/p/blog/d/myblog/git/raw/master/img/post-2020-prim.jpg)

上图中的 PriorityQueue 中的元组表示相邻点 ID 与连接边的权值，其中用红框选中的是下一次循环会被弹出队列的顶点。
在右边的图中，同一顶点 B 存在两个，但是不要紧，权值更小的 `(B, 4)` 会先被访问，那么 `(B, 6)` 最终会因为 B 已在 MST 中而被忽略。
具体实现参考后面的 Dijkstra 算法示例，两者有一定的一致性。

而 Kruskal 算法的实现的具体步骤一般是：

1. 把所有的边按权值升序排列
2. 创建一个空的并查集用于保存 MST 中的点
3. 依次遍历每一条边，判断它的两个点是否都已经在并查集里了（即是否在 MST 里）：
如是，则跳过；否则，把边记录入 MST，把点加入并查集

Kruskal 算法的练习题有 [1489.找到最小生成树里的关键边和伪关键边](https://leetcode-cn.com/problems/find-critical-and-pseudo-critical-edges-in-minimum-spanning-tree/)。

---

> 最后附上 GitHub：<https://github.com/gonearewe>
